# -- Options {{{1
# --------------------------------------------------------------------------------------------------

# Use miller column mode which show multiple levels of the hierarchy.
set viewmode miller

# Column pattern to define their relative widths.
set column_ratios 2,2,3,3

# The filter that defines which files should be hidden.
set hidden_filter ^\.DS_Store$

# Show hidden files? Toggle by typing 'zh'.
set show_hidden false

# Ask for a confirmation when running the "delete" command.
set confirm_on_delete always

# Use the external preview script to display simple plain text or image previews.
set use_preview_script true

# Automatically count files in the directory, even before entering them.
set automatically_count_files true

# Open all images in this directory when running certain image viewers.
set open_all_images true

# Be aware of version control systems and display information.
set vcs_aware false

# State of the version control system.
set vcs_backend_git enabled

# Do not attempt to show the preview of image.
set preview_images false

# Set the preview image method.
set preview_images_method urxvt

# Use a unicode "..." character to mark cut-off filenames.
set unicode_ellipsis true

# Show dotfiles in the bookmark preview box.
set show_hidden_bookmarks true

# Color theme.
set colorscheme default

# Preview files and directories on the rightmost column.
set preview_files true
set preview_directories true

# Disable collapsing the last column if there is nothing to preview.
set collapse_preview false

# Save the console history on exit.
set save_console_history true

# Draw the status bar on bottom of the browser window.
set status_bar_on_top false

# Draw a progress bar for tasks in the status bar.
set draw_progress_bar_in_status_bar true

# Disable drawing borders around columns.
set draw_borders false

# Display the directory name in tabs.
set dirname_in_tabs true

# Enable the mouse support.
set mouse_enabled true

# Display the file size in the main column or status bar.
set display_size_in_main_column true
set display_size_in_status_bar true

# Display files tags in all columns.
set display_tags_in_all_columns true

# Don't set a title for the window.
set update_title false

# Set the title to "ranger" in the tmux program.
set update_tmux_title true

# Shorten the title if it gets long.
set shorten_title 3

# Show hostname in titlebar.
set hostname_in_titlebar true

# Abbreviate $HOME with `~` in the title bar.
set tilde_in_titlebar true

# Size of the directory-changes and console-commands history.
set max_history_size 20
set max_console_history_size 50

# Try to keep this much space between the top/bottom border when scrolling.
set scroll_offset 8

# Flush the input after each key hit.
set flushinput true

# Enable padding on the right when there is no preview.
set padding_right true

# Save bookmarks when ranger is exited.
set autosave_bookmarks false

# Save the "`" bookmark to disk.
set save_backtick_bookmark true

# Don't calculate the cumulative size of directories.
set autoupdate_cumulative_size false

# Hide terminal's cursor.
set show_cursor false

# Default sorting algorithm and options.
set sort natural
set sort_reverse false
set sort_case_insensitive true
set sort_directories_first true
set sort_unicode false

# Don't emulate xterm Alt key.
set xterm_alt_key false

# Don't include bookmarks in `cd` command.
set cd_bookmarks false

# Sensitivity for the `cd` command tab completion.
set cd_tab_case sensitive

# Use smart tab completion with less typing for `cd` command.
set cd_tab_smart false

# Avoid previewing files larger than this size in bytes. 0 to disable.
set preview_max_size 50000000

# Add the highlighted file to the path in the title bar.
set show_selection_in_titlebar true

# The delay that ranger idly waits for user input in milliseconds.
set idle_delay 2000

# Disable deep recursive searching metadata files.
set metadata_deep_search false

# Don't clear all existing filters when leaving a directory.
set clear_filters_on_dir_change false

# Disable displaying line numbers in main column.
set line_numbers false

# Start line numbers from 1 instead of 0.
set one_indexed true

# Save tabs on exit.
set save_tabs_on_exit true

# Disable moving very down wrap around to the top and vice versa.
set wrap_scroll false

# Set the global_inode_type_filter to nothing.
set global_inode_type_filter

# -- Interface {{{1
# --------------------------------------------------------------------------------------------------

# Quit if there is no task and tab or quit if there is no task.
map q quit
map Q quitall

# Abort current operation.
map <C-c> abort

# Cancel current operation.
map <Esc> change_mode normal

# Display the file inside pager.
map i display_file

# Edit highlighted file.
map e edit

# Open console prompt.
map : console

# Display help about components.
map ? help

# Open taskview or display logs.
map w taskview_open
map W display_log

# Execute shell session as child process.
map s shell $SHELL

# Ask to open highlighted item with possible programs.
map L chain draw_possible_programs; console open_with%%space

# Change the line mode.
map xf linemode filename
map xp linemode permissions
map xs linemode sizemtime

# Temporarily toggle options or reload components.
map zh set show_hidden!
map zv set viewmode!
map zc reload_cwd
map zr reset
map zl redraw_window

# Sort items according to the algorithm.
map os chain set sort=size; set sort_reverse=False
map ob chain set sort=basename; set sort_reverse=False
map on chain set sort=natural; set sort_reverse=False
map om chain set sort=mtime; set sort_reverse=False
map oc chain set sort=ctime; set sort_reverse=False
map oa chain set sort=atime; set sort_reverse=False
map ot chain set sort=type; set sort_reverse=False
map oe chain set sort=extension; set sort_reverse=False

# -- Operations {{{1
# --------------------------------------------------------------------------------------------------

# Create file, directory or achieve.
map cf console touch%space
map cd console mkdir%space
map cc console compress%space

# Cut.
map dd cut mode=toggle
map ud uncut

# Delete.
map dD shell -f trash %s

# Yank.
map yy copy mode=toggle
map uy uncut
map yp yank path
map yd yank dir
map yn yank name

# Paste.
map pp paste append=True
map po paste overwrite=True append=True
map pl paste_symlink relative=False
map pL paste_symlink relative=True
map ph paste_hardlink

# Rename.
map ra rename_append
map ri eval fm.open_console('rename ' + fm.thisfile.relative_path.replace('%', '%%'), position=7)
map rw eval fm.execute_console('bulkrename') if fm.thisdir.marked_items else fm.open_console('rename ')

# `chmod` current selected item.
map = console -p15 shell -f chmod  "%s"

# -- Visual {{{1
# --------------------------------------------------------------------------------------------------

# Toggle or undo tag.
map a tag_toggle
map ua tag_remove

# Set the tag as given letter.
map "<any> tag_toggle tag=%any

# Select highlighted item visually.
map <Space> mark_files toggle=True

# Select all items in column visually.
map v mark_files all=True toggle=True

# Undo all visual selections.
map uv mark_files all=True val=False

# Toggle and exit visual line mode.
map V toggle_visual_mode

# Set, unset and enter mark.
map m<any> set_bookmark %any
map um<any> unset_bookmark %any
map `<any> enter_bookmark %any

# Show current marks while performing mark operations.
map m<bg> draw_bookmarks
copymap m<bg> um<bg> `<bg>

# -- Navigation {{{1
# --------------------------------------------------------------------------------------------------

# Enter inside directory or open file.
map <CR> move right=1

# Navigate up and down.
map k move up=1
map j move down=1
map h move left=1
map l move right=1
copymap k <Up>
copymap j <Down>
copymap h <Left>
copymap l <Right>

# Jump top and bottom.
map gg move to=0
map G move to=-1

# Halfway scroll window upwards and downwards.
map J move down=0.5 pages=True
map K move up=0.5 pages=True
copymap J <C-d>
copymap K <C-u>

# Full-page scroll window upwards and downwards.
map <PageDown> move down=1 pages=True
map <PageUp> move up=1 pages=True
copymap <PageDown> <C-F>
copymap <PageUp> <C-B>

# Go back and forward in history.
map { history_go -1
map } history_go 1

# Navigate parent-wise while keeping the current position.
map ] move_parent 1
map [ move_parent -1

# Jump first directory or file.
map ; jump_non

# -- Bookmarks {{{1
# --------------------------------------------------------------------------------------------------

# Core bookmarks.
map gh cd ~
map g/ cd /
map ge cd /etc
map gu cd /usr
map gd cd /dev
map go cd /opt
map gv cd /var
map gm cd /media
map gM cd /mnt
map gt cd /tmp
map gl cd -r .
map gL cd -r %f
map gr eval fm.cd(fm.start_paths[0])

# Custom bookmarks.
map be cd ~/Desktop/
map bd cd ~/Documents/
map bw cd ~/Downloads/
map bi cd ~/Pictures/
map bp cd ~/Projects/
map bv cd ~/Videos/

# -- Searching {{{1
# --------------------------------------------------------------------------------------------------

# Filter with regex permanently in current column and undo.
map f console scout -fprst%space
map uf scout -fp

# Search with regex in current column.
map / console scout -rst%space

# Go next and previous search result.
map n search_next
map N search_next forward=False

# Search and select file or directory recursively with using `fzf`.
map <C-f> select

# Locate a file globally with using `fzf`.
map <C-l> locate

# -- Tabs {{{1
# --------------------------------------------------------------------------------------------------

# Create a new tab.
map tn tab_new

# Navigate left and right between tabs.
map th tab_move -1
map tl tab_move 1

# Close current tab.
map tx tab_close

# Restore the last closed tab.
map ut tab_restore

# -- Console {{{1
# --------------------------------------------------------------------------------------------------

# Completion.
cmap <Tab> eval fm.ui.console.tab()
cmap <S-Tab> eval fm.ui.console.tab(-1)

# Proceeding.
cmap <Esc> eval fm.ui.console.close()
cmap <CR> eval fm.ui.console.execute()
copycmap <CR> <C-j>
copycmap <Esc> <C-c>
copycmap <Esc> <C-g>

# Line editing.
cmap <Left> eval fm.ui.console.move(left=1)
cmap <Right> eval fm.ui.console.move(right=1)
cmap <Backspace> eval fm.ui.console.delete(-1)
cmap <Delete> eval fm.ui.console.delete(0)
cmap <C-w> eval fm.ui.console.delete_word()
cmap <C-u> eval fm.ui.console.delete_rest(-1)
cmap <Allow_Quantifiers> false
copycmap <Backspace> <C-h>
copycmap <Backspace> <Backspace2>

# -- Pager {{{1
# --------------------------------------------------------------------------------------------------

# Navigation.
pmap k pager_move up=1
pmap j pager_move down=1
pmap h pager_move left=4
pmap l pager_move right=4
pmap g pager_move to=0
pmap G pager_move to=-1
pmap d pager_move down=0.5 pages=True
pmap u pager_move up=0.5 pages=True
pmap f pager_move down=1.0 pages=True
pmap b pager_move up=1.0 pages=True
copypmap k <Up>
copypmap j <Down>
copypmap h <Left>
copypmap l <Right>
copypmap d <C-d>
copypmap u <C-u>
copypmap f <C-f>
copypmap b <C-b>

# Basic operations.
pmap zl redraw_window
pmap e edit_file
pmap <Esc> pager_close
copypmap <Esc> q i

# -- Taskview {{{1
# --------------------------------------------------------------------------------------------------

# Navigation.
tmap k taskview_move up=1
tmap j taskview_move down=1
tmap g taskview_move to=0
tmap G taskview_move to=-1
tmap d taskview_move down=0.5 pages=True
tmap u taskview_move up=0.5 pages=True
tmap f taskview_move down=1.0 pages=True
tmap b taskview_move up=1.0 pages=True
copytmap k <Up>
copytmap j <Down>
copytmap u <C-u>
copytmap f <C-f>
copytmap b <C-b>

# Task operations.
tmap J eval -q fm.ui.taskview.task_move(-1)
tmap K eval -q fm.ui.taskview.task_move(0)
tmap dd eval -q fm.ui.taskview.task_remove()

# Basic operations.
tmap zl redraw_window
tmap <Esc> taskview_close
copytmap <Esc> q w

# -- Aliases {{{1
# --------------------------------------------------------------------------------------------------

alias e edit
alias q quit
alias q! quit!
alias qa quitall
alias qa! quitall!
alias qall quitall
alias qall! quitall!
alias setl setlocal
alias rm delete

# }}} vim: foldmethod=marker foldlevel=0
